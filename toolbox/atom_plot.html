<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" /><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Plotting atom output &mdash; sisl 0.1.dev1+g851d78c documentation</title>
      <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
      <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
      <link rel="stylesheet" href="../_static/plot_directive.css" type="text/css" />
      <link rel="stylesheet" href="../_static/graphviz.css" type="text/css" />
      <link rel="stylesheet" href="../_static/sg_gallery.css" type="text/css" />
  <!--[if lt IE 9]>
    <script src="../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
        <script src="../_static/jquery.js"></script>
        <script src="../_static/underscore.js"></script>
        <script src="../_static/_sphinx_javascript_frameworks_compat.js"></script>
        <script src="../_static/doctools.js"></script>
        <script src="../_static/sphinx_highlight.js"></script>
        <script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
        <script src="https://unpkg.com/@jupyter-widgets/html-manager@^0.20.1/dist/embed-amd.js"></script>
        <script>window.MathJax = {"tex": {"inlineMath": [["$", "$"], ["\\(", "\\)"]], "processEscapes": true}, "options": {"ignoreHtmlClass": "tex2jax_ignore|mathjax_ignore|document", "processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
        <script defer="defer" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.7/latest.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <script src="../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="ASE" href="../visualization/ase/index.html" />
    <link rel="prev" title="TranSiesta Hartree correction for FFT Poisson solver" href="ts_fft.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
            <a href="../index.html" class="icon icon-home"> sisl
          </a>
              <div class="version">
                0.1.dev1+g851d78c
              </div>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <ul>
<li class="toctree-l1"><a class="reference internal" href="../introduction.html">Introduction</a></li>
<li class="toctree-l1"><a class="reference internal" href="../changelog/index.html">Release notes</a></li>
<li class="toctree-l1"><a class="reference internal" href="../contribute.html">Contributing</a></li>
<li class="toctree-l1"><a class="reference internal" href="../other.html">Other resources</a></li>
<li class="toctree-l1"><a class="reference internal" href="../cite.html">Citing sisl</a></li>
<li class="toctree-l1"><a class="reference internal" href="../publications.html">Publications using sisl</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">User Guide</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../installation.html">Installation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../tutorials.html">Tutorials</a></li>
<li class="toctree-l1"><a class="reference internal" href="../scripts/scripts.html">Command line scripts</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Toolboxes</span></p>
<ul class="current">
<li class="toctree-l1 current"><a class="reference internal" href="index.html">Toolboxes</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="ts_fft.html">TranSiesta Hartree correction for FFT Poisson solver</a></li>
<li class="toctree-l2 current"><a class="current reference internal" href="#">Plotting <em class="xref py py-obj">atom</em> output</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#command-line-tool">Command line tool</a></li>
<li class="toctree-l3"><a class="reference internal" href="#input-generation">Input generation</a></li>
</ul>
</li>
</ul>
</li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Visualization</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../visualization/ase/index.html">ASE</a></li>
<li class="toctree-l1"><a class="reference internal" href="../visualization/viz_module/index.html">The <code class="docutils literal notranslate"><span class="pre">sisl.viz</span></code> module</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Reference documentation</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../api/index.html">API documentation</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">sisl</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../index.html" class="icon icon-home"></a></li>
          <li class="breadcrumb-item"><a href="index.html">Toolboxes</a></li>
      <li class="breadcrumb-item active">Plotting <em class="xref py py-obj">atom</em> output</li>
      <li class="wy-breadcrumbs-aside">
            <a href="../_sources/toolbox/atom_plot.rst.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  
<style>
/* CSS overrides for sphinx_rtd_theme */

/* 24px margin */
.nbinput.nblast.container,
.nboutput.nblast.container {
    margin-bottom: 19px;  /* padding has already 5px */
}

/* ... except between code cells! */
.nblast.container + .nbinput.container {
    margin-top: -19px;
}

.admonition > p:before {
    margin-right: 4px;  /* make room for the exclamation icon */
}

/* Fix math alignment, see https://github.com/rtfd/sphinx_rtd_theme/pull/686 */
.math {
    text-align: unset;
}
</style>
<section id="plotting-atom-output">
<span id="toc-tool-atom-plot"></span><h1>Plotting <em class="xref py py-obj">atom</em> output<a class="headerlink" href="#plotting-atom-output" title="Permalink to this heading"></a></h1>
<p>Suggestions and improvements to this utility is most welcome!</p>
<p>Creating pseudopotentials using <a class="reference external" href="https://siesta-project.org/SIESTA_MATERIAL/Pseudos/atom_licence.html">atom</a> will often require users to
post-analyze the output of the program.</p>
<p>Here we aid this visualization process by adding a command line interface
for plotting details of the output via a simple command.</p>
<section id="command-line-tool">
<h2>Command line tool<a class="headerlink" href="#command-line-tool" title="Permalink to this heading"></a></h2>
<p>It may be called using</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>stoolbox<span class="w"> </span>atom-plot<span class="w"> </span>&lt;atom-output-directory&gt;
</pre></div>
</div>
<p>which by default will create 4 plots.</p>
<a class="reference internal image-reference" href="../_images/atom_plot_output.png"><img alt="Default `stoolbox atom-plot` output" class="align-center" src="../_images/atom_plot_output.png" style="width: 500px;" /></a>
<p>It mimicks the shell commands provided by <a class="reference external" href="https://siesta-project.org/SIESTA_MATERIAL/Pseudos/atom_licence.html">atom</a> for plotting with some additional details.</p>
<p>By default the program will output details regarding the core-charge and valence charge
overlap (use full for determining whether core-corrections should be used).</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>Total<span class="w"> </span>charge<span class="w"> </span><span class="k">in</span><span class="w"> </span>atom:<span class="w"> </span><span class="m">82</span>.00213
Core-correction<span class="w"> </span>r_pc<span class="w"> </span><span class="o">[</span><span class="m">2</span>.0,<span class="w"> </span><span class="m">1</span>.5,<span class="w"> </span><span class="m">1</span><span class="o">]</span>:<span class="w"> </span><span class="o">[</span><span class="m">0</span>.8656676967,<span class="w"> </span><span class="m">0</span>.9330918445,<span class="w"> </span><span class="m">1</span>.0573356051<span class="o">]</span><span class="w"> </span>Bohr
</pre></div>
</div>
<p>Here it is for lead and the first line gives the total charge in the atom calculation.
Note that the deviation stems from the different integration schemes used in the toolbox
and in <a class="reference external" href="https://siesta-project.org/SIESTA_MATERIAL/Pseudos/atom_licence.html">atom</a>.
The 2nd line prints details about the where the core charge is some factor larger than
the pseudo potential valence charge. In this case it prints the radii <span class="math notranslate nohighlight">\(r_i\)</span> where
<span class="math notranslate nohighlight">\(\rho_{\mathrm{core}}(r_i)/\rho_{\mathrm{valence}}(r_i)\)</span> equals <span class="math notranslate nohighlight">\(2\)</span>, <span class="math notranslate nohighlight">\(1.5\)</span> and <span class="math notranslate nohighlight">\(1\)</span>.</p>
<p>The full overlap is printed in the title of the charge plot. It is calculated as:</p>
<div class="math notranslate nohighlight">
\[\mathcal O = \int \mathrm{min}(\rho_{\mathrm{core}}(r), \rho_{\mathrm{valence}}(r)) \mathrm dr\]</div>
</section>
<section id="input-generation">
<h2>Input generation<a class="headerlink" href="#input-generation" title="Permalink to this heading"></a></h2>
<p>The tool can also be used to generate the input files for <a class="reference external" href="https://siesta-project.org/SIESTA_MATERIAL/Pseudos/atom_licence.html">atom</a>. While it is possible to read
input files from <code class="docutils literal notranslate"><span class="pre">INP</span></code> files, one may also define a specific <em class="xref py py-obj">Atom</em> object which
will be used to generate the input file.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">sisl</span> <span class="kn">import</span> <span class="o">*</span>
<span class="kn">from</span> <span class="nn">sisl_toolbox.siesta.atom</span> <span class="kn">import</span> <span class="o">*</span>

<span class="n">s</span> <span class="o">=</span> <span class="n">AtomicOrbital</span><span class="p">(</span><span class="n">n</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span> <span class="n">l</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">q0</span><span class="o">=</span><span class="mf">1.</span><span class="p">,</span> <span class="n">R</span><span class="o">=</span><span class="mf">2.4</span><span class="p">)</span>
<span class="n">p</span> <span class="o">=</span> <span class="n">AtomicOrbital</span><span class="p">(</span><span class="n">n</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span> <span class="n">l</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">q0</span><span class="o">=</span><span class="mf">0.</span><span class="p">,</span> <span class="n">R</span><span class="o">=</span><span class="mf">1.6</span><span class="p">)</span>
<span class="n">d</span> <span class="o">=</span> <span class="n">AtomicOrbital</span><span class="p">(</span><span class="n">n</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span> <span class="n">l</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">q0</span><span class="o">=</span><span class="mf">10.</span><span class="p">,</span> <span class="n">R</span><span class="o">=</span><span class="mf">1.4</span><span class="p">)</span>
<span class="n">f</span> <span class="o">=</span> <span class="n">AtomicOrbital</span><span class="p">(</span><span class="n">n</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span> <span class="n">l</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">q0</span><span class="o">=</span><span class="mf">0.</span><span class="p">,</span> <span class="n">R</span><span class="o">=</span><span class="mf">2.</span><span class="p">)</span>

<span class="n">Ag</span> <span class="o">=</span> <span class="n">Atom</span><span class="p">(</span><span class="s2">&quot;Ag&quot;</span><span class="p">,</span> <span class="n">orbitals</span><span class="o">=</span><span class="p">[</span><span class="n">s</span><span class="p">,</span> <span class="n">p</span><span class="p">,</span> <span class="n">d</span><span class="p">,</span> <span class="n">f</span><span class="p">])</span>

<span class="n">atom_input</span> <span class="o">=</span> <span class="n">AtomInput</span><span class="p">(</span><span class="n">Ag</span><span class="p">,</span> <span class="n">rcore</span><span class="o">=</span><span class="mf">2.</span><span class="p">,</span> <span class="n">xc</span><span class="o">=</span><span class="s2">&quot;pb&quot;</span><span class="p">,</span> <span class="n">flavor</span><span class="o">=</span><span class="s2">&quot;tm2&quot;</span><span class="p">)</span>

<span class="c1"># write the INP file in current directory</span>
<span class="n">atom_input</span><span class="o">.</span><span class="n">pg</span><span class="p">()</span>
</pre></div>
</div>
</section>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="ts_fft.html" class="btn btn-neutral float-left" title="TranSiesta Hartree correction for FFT Poisson solver" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="../visualization/ase/index.html" class="btn btn-neutral float-right" title="ASE" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2015-2023, Nick Papior.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>